<!--

🛑 DO NOT EDIT THIS FILE.

This AGENT.md defines core Codex responsibilities and must remain stable.

Stack-specific variations belong in /tech-guides/{language}.md

-->

# AGENT.md – Codex Frontend Execution Guide

Welcome! This document defines how Codex contributes to our frontend codebase (React, Vue, Flutter, Svelte, Angular). All contributions must follow component-driven architecture, test-first development, and strict spec alignment.

> 📘 For global Codex rules, see [`/AGENTS.md`](../AGENTS.md).
> 📚 For task specs, GPT roles, and architecture rules, see [`/ENGINEERING_GUIDE.md`](../ENGINEERING_GUIDE.md).
> 📐 For frontend architecture by stack, see [`/frontend/tech-guides/README.md`](./tech-guides/README.md)

---

## 👥 Project Structure & Roles

```
/frontend/
├── web/         → Web UI (Next.js, Vue, Svelte, etc.)
├── mobile/      → Mobile UI (React Native, Flutter)
├── shared/      → Platform-neutral logic (hooks, schemas, types, forms)
├── tech-guides/ → Execution rules for each platform
```

Codex must:

* Follow tasks authored by The Polyglot
* Only implement what is defined in the associated TECH_SPEC
* Never invent UI, behavior, routes, or props
* Keep shared logic type-safe and platform-agnostic

---

## 🧠 Codex Execution Rules

* Always enforce validation using Zod
* Never place business logic inside components
* Use design tokens, accessibility rules, and platform-native conventions
* Never mix platform-specific logic in `/shared/`

### ✅ Preflight Checklist

- [ ] Look for existing component, hook, or schema
- [ ] Extend or refactor if partially implemented
- [ ] Avoid duplicating state logic or data fetches
- [ ] Confirm validation and test coverage

---

## 📖 Codex-Required Tech Guides

Codex MUST recursively scan all `.md` files inside the following directories:

* `/frontend/tech-guides/web/`
* `/frontend/tech-guides/mobile/`
* `/frontend/tech-guides/shared/`
* `/frontend/tech-guides/frontend_conventions.md`
* `/frontend/tech-guides/README.md`

---

## 📓 Task Tracker Enforcement

Codex must log each frontend task to `/codex_task_tracker.md` with:

* Context: frontend
* Task Title
* Phase
* Status: ✅ Done | ⏳ In Progress
* Layer: screen, form, hook, api, validation, schema
* Platform: web | mobile | shared
* Domain
* Module
* Epic
* Feature
* Description
* Test Status
* Created/Updated timestamps

Use: `/frontend/utils/taskLogger.ts`  
Methods: `updateTaskTracker()`, `hasDuplicateTask()`, `cleanBacklog()`

---

## 🧩 Task Format (From The Polyglot)

```
💻 Codex Task: [Component / Screen / Hook / Utility]
🗭 Context: frontend | shared
📁 Platform: web | mobile | shared
🎯 Objective: what it delivers

🧱 Module: [e.g. BillingForm]
📦 Epic: [e.g. Payments Infrastructure]
🔧 Feature: [e.g. Checkout Flow]

🧲 Specs:
- Props / Inputs
- Validation: Zod / Yup
- UI Design: Tailwind / Dripsy / native
- Behavior: click, tap, swipe, async flow
- Data: hook | context | API
- Routing (if any)

🧪 Tests:
- Validate all inputs and edge cases
- Simulate interactions
- Confirm navigation or mutations
```

---

## ✅ Commits & PRs

* One task = one PR
* Use [Conventional Commits](https://www.conventionalcommits.org/):

  * `feat(web): add CheckoutForm`
  * `fix(mobile): fix SafeArea bug`
* Format code and confirm test pass before pushing

---

## 🧪 Testing Standards

Codex must write colocated tests using stack-native tools:

| Platform     | Tools                                          |
| ------------ | ---------------------------------------------- |
| React        | `@testing-library/react`, `jest`               |
| Vue          | `vitest`, `vue/test-utils`                     |
| Svelte       | `svelte-testing-library`, `vitest`             |
| React Native | `@testing-library/react-native`, `jest`        |
| Flutter      | `flutter_test`, `mockito`, `integration_test`  |

Test must cover:

* Render success/failure
* Input validation
* Mutation behavior
* Loading and error states

---

## 🎨 Styling & Accessibility

* Use design tokens (theme.ts, ThemeData, nativewind.config.js)
* Never hardcode layout, spacing, colors, or text
* Enforce:

  * Dark mode compatibility
  * Semantic HTML (web)
  * Safe Area (mobile)
  * A11Y: labels, focus, tap size, contrast

---

## 🔁 Layering Rules (Frontend Clean Arch)

```
Screen
↓
Form / Controller
↓
Hook / Store
↓
API Service
↓
Zod Schema
```

Each layer must be:

* Type-safe
* Fully tested
* Explicitly documented in TECH_SPEC

---

## 🧠 Shared Logic Rules

All `/shared/` logic must:

* Be framework-agnostic
* Avoid use of `window`, `document`, `react-native`, `flutter`
* Include colocated tests
* Use TypeScript and Zod
* Expose interfaces/hooks for reuse in `web` and `mobile`

---

## 🔒 Codex Must Never

* Invent new props, APIs, or UI flows
* Mix platform logic in shared
* Skip Zod validation
* Write untested components or hooks
* Use `any` or untyped states
* Hardcode string, layout, color

---

## 📘 Documentation Alignment

All tasks must trace to:

```
/docs/frontend/<domain>/<module>/TECH_SPEC.frontend.md
```

Codex must never build a UI or feature that is not clearly defined in the spec.

---

This is the immutable frontend execution contract for Codex.
It enforces architecture layering, validation, styling consistency, and TDD.
